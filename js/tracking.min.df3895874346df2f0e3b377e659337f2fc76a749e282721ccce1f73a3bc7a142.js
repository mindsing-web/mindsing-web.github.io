(function(){"use strict";if(window.Tracking&&window.Tracking._initialized){window.HUGO_ENV==="development"&&console.log("[Tracking] Already initialized, skipping duplicate load");return}window.Tracking=window.Tracking||{},window.dataLayer=window.dataLayer||[],window.Tracking.debug=!1,window.Tracking.config={environment:window.HUGO_ENV||function(){var e=window.location.hostname;return e==="localhost"||e==="127.0.0.1"||e.includes(".local")||e.includes(":")?"development":e.includes("staging")||e.includes("test")||e.includes("dev.")?"staging":"production"}(),sendToGA4:!0,logEvents:window.HUGO_ENV==="development",environmentDimension:"environment",developerName:localStorage.getItem("developer_name")||"unknown_dev"};function e(e,t){(window.Tracking.debug||window.Tracking.config.logEvents)&&console.log("[Tracking]",e,t||"")}function t(){try{var t=localStorage.getItem("ga4_user_name")||sessionStorage.getItem("ga4_user_name")||"anonymous";return e("getCurrentUser:",t),t}catch(t){return e("getCurrentUser error:",t),"anonymous"}}function n(t){try{window.dataLayer=window.dataLayer||[],t.environment=window.Tracking.config.environment,t.timestamp=(new Date).toISOString(),window.Tracking.config.environment!=="production"&&(t.developer_name=window.Tracking.config.developerName,t.session_id=sessionStorage.getItem("dev_session_id")||"dev_session_"+Date.now(),sessionStorage.getItem("dev_session_id")||sessionStorage.setItem("dev_session_id",t.session_id)),e("Event prepared:",t),window.Tracking.config.sendToGA4?(window.dataLayer.push(t),e("Event sent to GA4. dataLayer length:",window.dataLayer.length)):e("GA4 sending disabled - event logged only:",t)}catch(t){console.warn("GA4 tracking error:",t),e("sendEvent error:",t)}}window.Tracking.passwordAccess=function(e,t){n({event:"password_protected_access",user_name:t,protection_id:e,event_category:"engagement",event_label:"protected_content_access"})},window.Tracking.calculatorCalculate=function(e){n({event:"calculator_calculate",calculator_type:e,user_name:t(),event_category:"engagement",event_label:"calculate_button_click"})},window.Tracking.addKeySuccess=function(e){n({event:"add_key_success",user_name:t(),key_method:e,event_category:"engagement",event_label:"add_encrypted_key"})},window.Tracking.formInteraction=function(e,s,o){var i={event:"form_interaction",form_type:e,form_action:s,user_name:t(),event_category:"engagement",event_label:e+"_"+s};o&&typeof o=="object"&&Object.keys(o).forEach(function(e){i[e]=o[e]}),n(i)},window.Tracking.contentView=function(e,s,o){var i={event:"content_view",content_type:e,content_id:s,user_name:t(),event_category:"engagement",event_label:e+"_view"};o&&typeof o=="object"&&Object.keys(o).forEach(function(e){i[e]=o[e]}),n(i)},window.Tracking.userAction=function(e,s){var o={event:"user_action",action:e,user_name:t(),event_category:"engagement",event_label:e};s&&typeof s=="object"&&Object.keys(s).forEach(function(e){o[e]=s[e]}),n(o)},window.Tracking.setUserName=function(e){if(!e||typeof e!="string")return;var t=e.trim();if(!t)return;try{localStorage.setItem("ga4_user_name",t),sessionStorage.setItem("ga4_user_name",t)}catch(e){console.warn("Failed to store user name for tracking:",e)}},window.Tracking.getUserName=t,window.Tracking.getStatus=function(){var e={trackingModuleLoaded:typeof window.Tracking!="undefined",dataLayerExists:typeof window.dataLayer!="undefined",dataLayerLength:window.dataLayer?window.dataLayer.length:0,currentUser:t(),debugMode:window.Tracking.debug,gtmLoaded:typeof window.google_tag_manager!="undefined",environment:window.Tracking.config.environment,sendToGA4:window.Tracking.config.sendToGA4,developerName:window.Tracking.config.developerName};return window.Tracking.config.logEvents&&console.log("Tracking Status:",e),e},window.Tracking.disableGA4=function(){window.Tracking.config.sendToGA4=!1,e("GA4 tracking disabled - events will be logged only")},window.Tracking.enableGA4=function(){window.Tracking.config.sendToGA4=!0,e("GA4 tracking enabled")},window.Tracking.setDeveloperName=function(t){t&&typeof t=="string"&&(window.Tracking.config.developerName=t.trim(),localStorage.setItem("developer_name",t.trim()),e("Developer name set to:",t.trim()))},window.Tracking.configureLocal=function(t){t=t||{},t.developerName&&window.Tracking.setDeveloperName(t.developerName),typeof t.sendToGA4=="boolean"&&(window.Tracking.config.sendToGA4=t.sendToGA4),typeof t.debug=="boolean"&&(window.Tracking.debug=t.debug),e("Local configuration updated:",window.Tracking.config)},e("Tracking module initialized"),window.Tracking.config.environment==="development"&&(window.Tracking.debug=!0,window.Tracking.config.logEvents=!0,e("Local development detected - debug mode enabled"),e("To disable GA4 in local, run: window.Tracking.disableGA4()"),e('To set your developer name, run: window.Tracking.setDeveloperName("YourName")')),window.Tracking.debug&&window.Tracking.getStatus(),window.Tracking._initialized=!0})()
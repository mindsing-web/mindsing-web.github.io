(function(){"use strict";function o(e,t){return(t||document).querySelector(e)}function s(e,t){return Array.prototype.slice.call((t||document).querySelectorAll(e))}function t(e,t,n){var s=document.createElement(e);return t=t||{},Object.keys(t).forEach(function(e){s.setAttribute(e,t[e])}),n&&(s.textContent=n),s}function e(t,n){n=n||{},this.root=t,this.id=n.id||t.getAttribute("data-protect-id")||"default",this.storageKey="password_gate_unlocked:"+this.id,this.password=n.password||t.getAttribute("data-password")||"",this.passwordHash=null,e.hashStore=e.hashStore||{};try{var o,i,a,r,s=t.closest?t.closest("main"):document.querySelector("main");if(s&&s.getAttribute)try{if(o=s.getAttribute("data-protect-password-hash"),i=s.getAttribute("data-protect-password"),o){e.hashStore[this.id]=e.hashStore[this.id]||{},e.hashStore[this.id].hash=o;try{s.removeAttribute("data-protect-password-hash")}catch{}this.passwordHash=o}else if(i){e.hashStore[this.id]=e.hashStore[this.id]||{},e.hashStore[this.id].plain=i;try{s.removeAttribute("data-protect-password")}catch{}this.password=i}}catch{}}catch{}this.buttonSelector=n.buttonSelector||".btn--access-content",this.button=null,this.overlay=null,this.actionBar=document.querySelector(".action-bar");try{e.hashStore=e.hashStore||{},e.hashStore[this.id]&&(e.hashStore[this.id].hash&&(this.passwordHash=e.hashStore[this.id].hash),e.hashStore[this.id].plain&&(this.password=e.hashStore[this.id].plain))}catch{}try{}catch{}if(this.actionBar){this.actionBar.classList.add("pw-action-hidden");try{if(r=this.actionBar.parentNode,r){a=document.createElement("div"),a.className="pw-actionbar-placeholder";try{r.replaceChild(a,this.actionBar)}catch{}this._actionBarOriginal=this.actionBar,this._actionBarPlaceholder=a,this._actionBarDetached=!0}}catch{}}this.init()}e.prototype.isUnlocked=function(){try{return localStorage.getItem(this.storageKey)==="1"}catch{return!1}},e.prototype.setUnlocked=function(e){try{e?localStorage.setItem(this.storageKey,"1"):localStorage.removeItem(this.storageKey)}catch{}},e.prototype.showContent=function(){if(this._detached&&this._placeholder&&this._originalNode)try{this._placeholder.parentNode.replaceChild(this._originalNode,this._placeholder),this.root=this._originalNode}catch{}if(this.root.style.display="",this.root.removeAttribute("aria-hidden"),this._actionBarDetached&&this._actionBarPlaceholder&&this._actionBarOriginal)try{this._actionBarPlaceholder.parentNode.replaceChild(this._actionBarOriginal,this._actionBarPlaceholder),this.actionBar=this._actionBarOriginal}catch{}this.actionBar&&this.actionBar.classList.remove("pw-action-hidden");try{document.body.classList.add("pw-unlocked")}catch{}try{window.formHelpers&&typeof window.formHelpers.flushDeferredInfoTooltips=="function"&&window.formHelpers.flushDeferredInfoTooltips()}catch{}try{document.body.classList.remove("pw-content-hidden")}catch{}if(!this.button)return;try{var e,n,s,o,t=null;try{t=this.button.closest?this.button.closest(".password-access-wrapper"):null}catch{t=null}if(t&&t.parentNode)t.remove?t.remove():t.parentNode.removeChild(t);else{e=this.button.parentNode;try{this.button.remove?this.button.remove():e&&e.removeChild(this.button)}catch{}try{if(e&&e.parentNode){for(n=!0,s=0;s<e.childNodes.length;s++){if(o=e.childNodes[s],o.nodeType===1){n=!1;break}if(o.nodeType===3&&(o.textContent||"").trim()!==""){n=!1;break}}n&&(e.remove?e.remove():e.parentNode.removeChild(e))}}catch{}}}catch{try{this.button.style.display="none"}catch{}}this.button=null},e.prototype.hideContent=function(){try{if(!this._detached&&this.root&&this.root.parentNode){var t,e=document.createElement("div");e.className="pw-protected-placeholder",e.setAttribute("aria-hidden","true");try{this.root.parentNode.replaceChild(e,this.root)}catch{}this._originalNode=this.root,this._placeholder=e,this._detached=!0}}catch{}try{this.root.style.display="none"}catch{}try{this.root.setAttribute&&this.root.setAttribute("aria-hidden","true")}catch{}if(this.button)try{this.button.classList.remove("pw-access-visible")}catch{}this.actionBar&&this.actionBar.classList.add("pw-action-hidden");try{document.body.classList.remove("pw-unlocked")}catch{}try{t=!!document.querySelector(".btn--access-content.pw-access-visible"),t||document.body.classList.add("pw-buttons-hidden");try{document.body.classList.add("pw-content-hidden")}catch{}}catch{}},e.prototype.buildOverlay=function(){var e,s,i,a,r,c,l,u,o=this,n=t("div",{class:"password-gate-overlay",role:"dialog","aria-modal":"true"});n.style.position="fixed",n.style.inset="0",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.background="rgba(0,0,0,0.6)",n.style.zIndex=3e4,e=t("div",{class:"password-gate-box"}),e.style.background="#fff",e.style.padding="20px",e.style.borderRadius="6px",e.style.maxWidth="420px",e.style.width="90%",e.style.boxShadow="0 6px 24px rgba(0,0,0,0.3)",l=t("h3",{},"Enter password to access content"),l.style.marginTop="0",u=t("p",{},"This content is password protected."),s=t("input",{type:"password",class:"password-gate-input","aria-label":"Password"}),s.style.width="100%",s.style.padding="8px 10px",s.style.marginTop="8px",s.style.boxSizing="border-box",i=t("div",{class:"password-gate-error"}),i.style.color="red",i.style.minHeight="18px",i.style.marginTop="8px",a=t("div",{class:"password-gate-controls"}),a.style.marginTop="12px",a.style.textAlign="right",r=t("button",{type:"button",class:"btn btn--secondary password-gate-cancel"},"Cancel"),c=t("button",{type:"button",class:"btn btn--primary password-gate-ok"},"Enter"),r.style.marginRight="8px",a.appendChild(r),a.appendChild(c),e.appendChild(l),e.appendChild(u),e.appendChild(s),e.appendChild(i),e.appendChild(a),n.appendChild(e);function d(){try{document.body.removeChild(n)}catch{}document.removeEventListener("keydown",h,!0)}function h(e){e.key==="Escape"&&d(),e.key==="Enter"&&c.click()}return r.addEventListener("click",function(){d()}),c.addEventListener("click",function(){var e=s.value||"";(async function(){var n,a,r,t=!1;try{o.passwordHash&&window.crypto&&window.crypto.subtle?(n=(new TextEncoder).encode(e),a=await window.crypto.subtle.digest("SHA-256",n),r=Array.prototype.map.call(new Uint8Array(a),function(e){return("00"+e.toString(16)).slice(-2)}).join(""),r===o.passwordHash&&(t=!0)):e===o.password&&(t=!0)}catch{t=!1}if(t){o.setUnlocked(!0);try{sessionStorage.setItem("password_gate:"+o.id,e)}catch{}try{localStorage.setItem("password_gate:"+o.id,e)}catch{}d(),o.showContent()}else i.textContent="Incorrect password",s.focus()})()}),document.addEventListener("keydown",h,!0),n},e.prototype.init=function(){var n,e=this,s=null;try{s=document.querySelector(this.buttonSelector+'[data-protect-id="'+this.id+'"]')||document.querySelector(this.buttonSelector)}catch{}if(this.button=s,this.isUnlocked()){this.showContent();return}if(this.hideContent(),!this.button){n=t("button",{type:"button",class:"btn btn--primary btn--access-content","data-protect-id":this.id},"Access Content"),this.button=n;try{this.root.parentNode.insertBefore(n,this.root)}catch{}}this.button.addEventListener("click",function(t){t.preventDefault();try{e.overlay=e.buildOverlay(),document.body.appendChild(e.overlay);var n=e.overlay.querySelector(".password-gate-input");n&&n.focus()}catch(e){console.error("PasswordGate open error",e)}},!0);try{if(!this.isUnlocked()){try{this.button.classList.add("pw-access-visible")}catch{}try{document.body.classList.remove("pw-buttons-hidden")}catch{}}}catch{}};function n(){s(".js-password-protected").forEach(function(t){try{var s={id:t.getAttribute("data-protect-id")||0[0],buttonSelector:".btn--access-content"},n=t.getAttribute("data-password");n&&(s.password=n),new e(t,s)}catch(e){console.error("PasswordGate init error",e)}})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n(),window.PasswordGate=e})()
// Import variables and modules early so variables are available
@import 'vars';
@import 'buttons';
@import 'hamburger-menu';

.not-allowed { cursor: not-allowed; }

#dime-summary h3.mt4 {
  margin-top: 1.25rem; /* extra padding above Life Insurance Target */
}

#dime-summary small {
  color: $muted-color; /* slightly muted */
}

/* Ensure the underlined DIME target's em is italic and stands out */
#dime-summary u em {
  font-style: italic;
}

// Global link styling - set default link color to brand orange
// Scope to main content only, exclude navigation and footer
main a:not(.bg-orange):not([class*="bg-"]):not(.btn),
main a:link:not(.bg-orange):not([class*="bg-"]):not(.btn),
main a:visited:not(.bg-orange):not([class*="bg-"]):not(.btn),
main .link:not(.bg-orange):not([class*="bg-"]):not(.btn),
main .link:link:not(.bg-orange):not([class*="bg-"]):not(.btn),
main .link:visited:not(.bg-orange):not([class*="bg-"]):not(.btn),
article a:not(.bg-orange):not([class*="bg-"]):not(.btn),
article a:link:not(.bg-orange):not([class*="bg-"]):not(.btn),
article a:visited:not(.bg-orange):not([class*="bg-"]):not(.btn),
article .link:not(.bg-orange):not([class*="bg-"]):not(.btn),
article .link:link:not(.bg-orange):not([class*="bg-"]):not(.btn),
article .link:visited:not(.bg-orange):not([class*="bg-"]):not(.btn) {
  color: $primary-color;
  text-decoration: none;

  &:hover,
  &:focus {
    color: darken($primary-color, 15%);
    text-decoration: underline;
  }
}

// Make `.info` elements show a hand cursor to indicate interactivity
a.info,
a.info:hover,
a.info:focus {
  cursor: pointer;
}

// External links - add arrow emoji
a[href^="http"]:not([href*="mindsing.com"])::after,
a[href^="https"]:not([href*="mindsing.com"])::after {
  content: " ↗️";
  font-size: 0.9em;
}

// Parallax section styles
.parallax-section {

  // Smooth parallax effect
  will-change: transform;

  .parallax-content {
    backdrop-filter: blur(2px);
    -webkit-backdrop-filter: blur(2px);
  }

  // Grid layout for content sections
  .grid-ns {
    @media (min-width: $tablet-breakpoint) {
      display: grid;
    }
  }

  .grid-2-ns {
    @media (min-width: $tablet-breakpoint) {
      grid-template-columns: 1fr 1fr;
    }
  }

  .gap4-ns {
    @media (min-width: $tablet-breakpoint) {
      gap: 2rem;
    }
  }

  // Mobile responsiveness
  @media (max-width: #{$tablet-breakpoint - 1px}) {
    background-attachment: scroll !important;
    min-height: auto !important;
    padding: 2rem 0 !important;

    .parallax-content {

      h2 {
        font-size: 2rem;
      }

      h3 {
        font-size: 1.5rem;
      }
    }
  }

  // Button transitions
  .transition-all {
    transition: all 0.3s ease;
  }
}

// Promoted blog images - fixed height with object-fit
.promoted-blog-image {
  height: 200px;

  img {
    object-fit: cover;
  }
}

// Promoted blog grid - uses CSS Grid for layout
.promoted-blog-grid {
  display: grid;
  gap: 1rem;

  @media (min-width: $tachyons-large-breakpoint) {
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
  }
}

// Promoted blog title - min height for alignment
.promoted-blog-title {
  @media (min-width: $tachyons-large-breakpoint) {
    min-height: 4.5rem; // Approximately 3 lines of text
  }
}

// Two-column grid layout - add gray well between columns
.flex-ns.flex-wrap {
  @media (min-width: $tachyons-large-breakpoint) {
    gap: 0 2rem; // Add gap between columns for the gray well

    .w-50-l {
      width: calc(50% - 1rem);
      padding-right: 0;
    }

    // Add gray background to the gap area
    position: relative;
    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      bottom: 0;
      width: 2rem;
      transform: translateX(-50%);
      background-color: $gray-100; // light gray well
      z-index: -1;
    }
  }
}

// Two-column content layout utility
.content-two-col {
  @media (min-width: $tablet-breakpoint) {
    column-count: 2;
    column-gap: 2rem;
  }

  // Force H2 to start a new column
  h2 {
    break-before: column;
    -webkit-column-break-before: column;
    page-break-before: always;
    break-after: avoid;
    -webkit-column-break-after: avoid;
    page-break-after: avoid;
    margin-top: 0;
  }

  // H3 and below should stay with following content
  h3, h4, h5, h6 {
    break-after: avoid;
    -webkit-column-break-after: avoid;
    page-break-after: avoid;
    break-inside: avoid;
    -webkit-column-break-inside: avoid;
    page-break-inside: avoid;
  }

  // Ensure lists don't break
  ul, ol {
    margin: 0 0 1rem 0;
    padding-left: 1.5rem;
    break-inside: avoid;
    -webkit-column-break-inside: avoid;
    page-break-inside: avoid;

    li {
      break-inside: avoid;
      -webkit-column-break-inside: avoid;
      page-break-inside: avoid;
      margin-bottom: 0.5rem;
    }
  }

  // Keep paragraphs together
  p {
    break-inside: avoid;
    -webkit-column-break-inside: avoid;
    page-break-inside: avoid;
  }

  // Keep heading + immediately following list together
  h3 + ul,
  h3 + ol,
  h4 + ul,
  h4 + ol {
    break-before: avoid;
    -webkit-column-break-before: avoid;
    page-break-before: avoid;
  }
}

// Brand color utilities
.orange {
  color: $primary-color;
}

.bg-orange {
  background-color: $primary-color;
}

.b--orange {
  border-color: $primary-color;
}

.hover-bg-orange:hover {
  background-color: $primary-color;
}

.bg-orange,
.orange.ba,
.site-logo {
  transition: transform 0.2s ease-in-out;
}

.bg-orange:hover,
.orange.ba:hover,
.site-logo:hover {
  transform: scale(1.1);
}

.bg-orange:hover {
  color: white;
  text-decoration: none;
}

.orange.ba:hover {
  color: $primary-color;
  text-decoration: none;
}

.navigation-main {
  a {
    text-decoration: none;
    transition: border-color 0.2s ease-in-out;

    @media (min-width: $desktop-breakpoint) {
      border-bottom: 1px solid transparent;
    }

    &:hover {
      border-bottom-color: #ffffff88;
      text-decoration: none;
    }
  }
}

.article-left-align .tc-l {
  text-align: left;
}

.text-style {
  &.--smaller {
    font-size: smaller;
  }

  &.--italic {
    font-style: italic;
  }
}

// Privacy banner styling
#privacy-banner {
  // Explicit consent mode styling
  &.privacy-mode-explicit {
    #reject-privacy {
      // Remove link styling
      text-decoration: none;

      // Add button styling
      border: 1px solid rgba(255, 255, 255, 0.4);
      background-color: transparent;
      padding: 0.5rem 1rem;
      border-radius: 0.25rem;
      display: inline-block;

      // Hover effect
      &:hover {
        background-color: rgba(255, 255, 255, 0.2);
      }
    }

    // Ensure the accept button is visible in explicit mode
    #accept-privacy {
      display: inline-block;
    }

    // Hide acknowledge button in explicit mode
    #acknowledge-privacy {
      display: none;
    }
  }

  // Auto-accept mode styling
  &.privacy-mode-auto {
    // Ensure the acknowledge button is visible in auto mode
    #acknowledge-privacy {
      display: inline-block;
    }

    // Hide accept button in auto mode
    #accept-privacy {
      display: none;
    }
  }
}

// Page teaser links (homepage summary cards)
article a.no-underline:hover,
.summary-with-image a:hover,
.summary a:hover {
  text-decoration: none;
}

// Service heading links - make them orange.
.bg-white h2 a.link.black.dim {
  color: $primary-color;

  &:hover {
    color: darken($primary-color, 15%);
    text-decoration: underline;
    opacity: 1;
  }
}

// Service heading links - make them orange.

// Required field asterisk
.required-asterisk {
  color: $primary-color;
  margin-right: 0.25rem;
}

// Secondary button variant
.btn--secondary {
  background-color: #fff;
  color: $primary-color;
  border-color: $primary-color;

  &:hover,
  &:focus {
    background-color: #fff;
    color: darken($primary-color, 10%);
    border-color: darken($primary-color, 10%);
  }
}

// Reusable dialog styles
.dialog {
  // Backdrop color for browsers that support ::backdrop
  &::backdrop {
    background: rgba(0,0,0,0.6);
  }

  max-width: 760px;
  width: calc(100% - 32px);

  border: 1px solid $border-color;
  border-radius: 8px;
  padding: 18px;
  box-sizing: border-box;
  background-color: #ffffff;

  // Ensure forms inside dialogs reset margin
  form { margin: 0; }

  // Small utility for dialog footer buttons
  .dialog-footer { text-align: right; margin-top: 12px; }

  textarea { min-height: 220px; padding: 12px; }

  // Slightly larger save button in dialogs
  button { &[id$="-save"] { padding: 8px 16px; } }

  // Responsive: full-screen on small devices
  @media (max-width: 640px) {
    width: 100%;
    height: 100%;
    max-width: none;
    border-radius: 0;
    padding: 16px;
  }
}

/* DIME calculator summary and spinner */
.dime-spinner {
  font-weight: 600;
  color: $primary-color;
}

#dime-summary {
  background: #fff;
  border: 0; // no border as requested
  border-radius: 8px;
  box-shadow: none;
}

/* Ensure primary action in summary looks prominent */
.btn--primary {
  padding: 0.75rem 1.25rem;
  font-size: 1rem;
}

/* Summary key styling: smaller, monospace, wrap */
/* Generic summary key styling used across calculators */
.summary-key,
.summary-key code {
  display: inline-block;
  font-family: $code-font;
  font-size: 8px;
  line-height: 1.2;
  word-break: break-all;
  max-width: 100%;
  color: $muted-dark;
}

/* Ensure the button row uses full width and buttons keep alignment */
#dime-summary .btn {
  min-width: 120px;
}

/* Disabled button appearance for action-bar controls */
.btn--disabled {
  opacity: 0.5;
  transform: none !important;
  /* Keep the disabled cursor visible when hovering or focusing. */
  cursor: not-allowed;
}

/* PasswordGate visibility helpers (moved from calculator layout inline <style>)
   Keep early CSS to prevent FOUC of protected content before JS runs. */
.pw-buttons-hidden .btn--access-content { display: none; }
.pw-buttons-hidden .btn--access-content.pw-access-visible { display: inline-block; }
.pw-action-hidden { visibility: hidden; }
.pw-content-hidden .js-password-protected { display: none; }

/* Hide the page title and calculator home link on calculator sub-pages until unlocked */
.calculator-page.pw-content-hidden h1 { display: none; }
.calculator-page.pw-content-hidden a[href="/calculator/"] { display: none; }

/* Generic helper: hide elements until the password gate unlocks.
  Apply `pw-hide-until-unlock` to any element that should be invisible
  until the site JS adds `pw-unlocked` to the body on successful unlock. */
.pw-hide-until-unlock { display: none !important; }
.pw-unlocked .pw-hide-until-unlock { display: inherit !important; }

/* Ensure hover/focus state still shows not-allowed cursor for disabled buttons */
.btn--disabled:hover,
.btn--disabled:focus {
  cursor: not-allowed;
}

// Responsive video embeds
.video {
  margin: 2rem 0;

  .video__wrapper {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 aspect ratio */
    padding-top: 25px;
    height: 0;
  }

  .video--youtube {
    iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }

  .video--html {
    video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }

  .video--vimeo {
    iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }
}

// Table of Contents styling
.toc {
  ul {
    list-style: none;
    padding-left: 0;
    margin: 0;

    li {
      margin-bottom: 0.5rem;

      a {
        color: $dark-gray;
        text-decoration: none;
        display: block;
        padding: 0.25rem 0;
        transition: color 0.2s ease;

        &:hover {
          color: $primary-color;
        }
      }
    }

    // Nested items (H3s under H2s)
    ul {
      padding-left: 1rem;
      margin-top: 0.25rem;

      li {
        margin-bottom: 0.25rem;
        font-size: 0.9em;
      }
    }
  }
}

// Sticky sidebar for desktop
.sticky-sidebar {
  @media (min-width: $tachyons-large-breakpoint) {
    position: sticky;
    top: 1rem;
    align-self: flex-start;
  }
}

// Mobile sticky TOC dropdown
.toc-mobile-sticky {
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);

  // Hide on desktop
  @media (min-width: $tachyons-large-breakpoint) {
    display: none !important;
  }

  select {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    width: 100%;
    font-size: 1.5rem;
    padding: 0.5em 3em 0.5em 0.75em;
    background-color: #fff;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3E%3Cpath fill='%23333' d='M8 11L3 6h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75em center;
    background-size: 16px;
    border: 1px solid #caced1;
    border-radius: 0.25rem;
    color: #000;
    cursor: pointer;

    &:focus {
      outline: 2px solid $primary-color;
      outline-offset: 2px;
      border-color: $primary-color;
    }

    option {
      font-size: 1.25rem;
      padding: 0.5em;
    }
  }
}

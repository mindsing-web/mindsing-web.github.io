{{ define "main" }}

<article
  class="cf ph4 pv3 pv4-l f4 center mw7 mw8-l lh-copy mid-gray {{ if .Params.article_class }}{{ .Params.article_class }}{{ else }}tc-l{{ end }}">
  {{ .Summary }}
</article>

{{/* Full-width parallax section */}}
<section class="parallax-section" style="
  min-height: 70vh;
  background-image: url('/images/colombia-parachute.jpg');
  background-attachment: fixed;
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
  padding: 3rem 0;
">  <div class="parallax-content white center mw7 ph4">
    <div class="bg-black-60 pa4 br3 tl">
      <div class="grid-ns grid-2-ns gap4-ns">
        <div class="mb4 mb0-ns">
          <h3 class="f3 fw6 mb3 white">Enterprise-Grade Solutions</h3>
          <p class="f5 lh-copy white-90">
            We build web systems designed to handle complex organizational needs, from multi-site management to advanced content workflows and enterprise integrations.
          </p>
        </div>

        <div class="mb4 mb0-ns">
          <h3 class="f3 fw6 mb3 white">Higher Education Expertise</h3>
          <p class="f5 lh-copy white-90">
            Extensive experience with university websites, student portals, learning management systems, and academic content management platforms.
          </p>
        </div>

        <div class="mb4 mb0-ns">
          <h3 class="f3 fw6 mb3 white">Open Source Leadership</h3>
          <p class="f5 lh-copy white-90">
            Deep expertise in Drupal and WordPress, with a focus on leveraging open source solutions to reduce costs while maximizing functionality and flexibility.
          </p>
        </div>

        <div class="mb4 mb0-ns">
          <h3 class="f3 fw6 mb3 white">Full-Stack Development</h3>
          <p class="f5 lh-copy white-90">
            From custom API development to frontend optimization, we handle every aspect of your web system architecture.
          </p>
        </div>
      </div>

      {{/* Services link */}}
      <div class="tc mt4 pt3 pb4">
        <a href="/services/" class="btn btn--secondary">
          View Our Services
        </a>
      </div>
    </div>
  </div>
</section>

{{/* Rest of the content after the parallax */}}
{{ if .Truncated }}
<article
  class="cf ph4 pv3 pv4-l f4 center mw7 mw8-l lh-copy mid-gray {{ if .Params.article_class }}{{ .Params.article_class }}{{ else }}tc-l{{ end }}">
  {{ replace .Content .Summary "" | safeHTML }}
</article>
{{ end }}

{{/* Define sections to pull recent posts from, excluding blog */}}
{{ $allPages := .Site.RegularPages }}
{{/* Filter out blog section pages */}}
{{ $section := where $allPages "Section" "!=" "blog" }}
{{/* Check to see if the section is defined for ranging through it */}}
{{ $section_count := len $section }}
{{ if ge $section_count 1 }}

<div class="pa3 pa4-ns center mw7 mw8-l">
  <h2 class="flex-none">
    {{ $.Param "recent_copy" | default "Enterprise Web Development Services" }}
  </h2>

  {{ $n_posts := $.Param "recent_posts_number" | default 4 }}

  <section>
    {{/* Range through filtered items, limiting to n_posts */}}
    {{ range first $n_posts $section }}
    <div class="relative w-100 mb4">
      {{ partial "summary-with-image.html" . }}
    </div>
    {{ end }}
  </section>


</div>
{{ end }}

{{/* Promoted Blog Posts Section */}}
{{ $blogPosts := where .Site.RegularPages "Section" "blog" }}
{{ $blogPosts = where $blogPosts "Params.promoted" true }}
{{ $promotedCount := len $blogPosts }}
{{ if ge $promotedCount 1 }}

<div class="pa3 pa4-ns center mw7 mw8-l">
  <h2 class="flex-none mb3">
    Featured Insights
  </h2>

  <section class="promoted-blog-grid">
    {{/* Show up to 3 most recent promoted blog posts */}}
    {{ range first 3 $blogPosts }}
    <div class="mb4">
      {{ partial "summary-promoted.html" . }}
    </div>
    {{ end }}
  </section>

  {{/* View All Blog Posts Button */}}
  <div class="tc mt4">
    <a href="/blog/" class="btn btn--primary">
      View All Blog Posts
    </a>
  </div>

</div>
{{ end }}

{{ end }}


<!doctype html><html lang=en><head><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r+"&gtm_auth=mRHZuF06IswzXy0_qX2HkQ&gtm_preview=env-1&gtm_cookies_win=x",a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-KPDPWFQ4")</script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>MindSing</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Calculator: URL Token Behavior
This README explains how the calculator serializes form values into an opaque token placed in the browser URL so results can be saved and later decoded to repopulate the form.
Where implemented:

Helpers are in web/assets/js/form__helpers.js.
The DIME calculator uses these helpers in web/assets/js/form__dime-calculator.js.

What it does:

When the calculator Calculate button is clicked the DIME calculator now creates an opaque token: a base64url-encoded JSON blob containing the serialized form values.
The token is written to the query string as ?{token} (for example ?eyJhb...) using history.replaceState() so the page does not reload.
The token is reversible — it can be decoded back into the original form values.

Programmatic usage:"><meta name=generator content="Hugo 0.150.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=stylesheet href=/ananke/css/main.min.00057f81b51bfe4689577775ee4e168b2e81858db7beff0f5a55402ed4c4c366.css><link rel=stylesheet href=/css/app.css><meta property="og:url" content="/calculator/readme/"><meta property="og:site_name" content="MindSing"><meta property="og:title" content="MindSing"><meta property="og:description" content="Calculator: URL Token Behavior This README explains how the calculator serializes form values into an opaque token placed in the browser URL so results can be saved and later decoded to repopulate the form.
Where implemented:
Helpers are in web/assets/js/form__helpers.js. The DIME calculator uses these helpers in web/assets/js/form__dime-calculator.js. What it does:
When the calculator Calculate button is clicked the DIME calculator now creates an opaque token: a base64url-encoded JSON blob containing the serialized form values. The token is written to the query string as ?{token} (for example ?eyJhb...) using history.replaceState() so the page does not reload. The token is reversible — it can be decoded back into the original form values. Programmatic usage:"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="calculator"><meta itemprop=name content="MindSing"><meta itemprop=description content="Calculator: URL Token Behavior This README explains how the calculator serializes form values into an opaque token placed in the browser URL so results can be saved and later decoded to repopulate the form.
Where implemented:
Helpers are in web/assets/js/form__helpers.js. The DIME calculator uses these helpers in web/assets/js/form__dime-calculator.js. What it does:
When the calculator Calculate button is clicked the DIME calculator now creates an opaque token: a base64url-encoded JSON blob containing the serialized form values. The token is written to the query string as ?{token} (for example ?eyJhb...) using history.replaceState() so the page does not reload. The token is reversible — it can be decoded back into the original form values. Programmatic usage:"><meta itemprop=wordCount content="768"><meta name=twitter:card content="summary"><meta name=twitter:title content="MindSing"><meta name=twitter:description content="Calculator: URL Token Behavior This README explains how the calculator serializes form values into an opaque token placed in the browser URL so results can be saved and later decoded to repopulate the form.
Where implemented:
Helpers are in web/assets/js/form__helpers.js. The DIME calculator uses these helpers in web/assets/js/form__dime-calculator.js. What it does:
When the calculator Calculate button is clicked the DIME calculator now creates an opaque token: a base64url-encoded JSON blob containing the serialized form values. The token is written to the query string as ?{token} (for example ?eyJhb...) using history.replaceState() so the page does not reload. The token is reversible — it can be decoded back into the original form values. Programmatic usage:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"MindSing","url":"\/","logo":{"@type":"ImageObject","url":"\/images/mindsing-logo.svg"},"description":"Specialized Drupal \u0026 WordPress development for enterprise, higher education, and global-scale web systems.","sameAs":[],"contactPoint":{"@type":"ContactPoint","email":"inquiries@mindsing.com","contactType":"customer service"}}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/"},{"@type":"ListItem","position":2,"name":"\"Calculator\"","item":"\/calculator/"},{"@type":"ListItem","position":3,"name":"\"\"","item":"\/calculator\/readme\/"}]}</script></head><body class="ma0 avenir bg-near-white production"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KPDPWFQ4%26gtm_auth%3dmRHZuF06IswzXy0_qX2HkQ%26gtm_preview%3denv-1%26gtm_cookies_win%3dx" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><div id=top></div><header><div class=bg-black><nav class="pv3 ph3 ph4-ns site-navigation" role=navigation><div class="flex justify-between items-center center" style=max-width:1440px><a href=/ class="f3 fw2 hover-white no-underline white-90 dib"><img src=/images/mindsing-logo.svg class="w100 mw5-ns site-logo" alt=MindSing>
</a><button class="hamburger-button dn-l bg-transparent white-90 bn pa2 pointer" aria-label="Toggle menu" aria-expanded=false><div class=hamburger-icon><span class=hamburger-line></span>
<span class=hamburger-line></span>
<span class=hamburger-line></span></div></button><div class="navigation-main flex-l items-center dn db-l" id=main-nav><ul class="pl0 mr3 flex-l list"><li class="f5 f4-ns fw4 dib-l db pr3-l pv2"><a class="hover-white no-underline white-90 db" href=/booking/ title="Schedule an Appointment page">Schedule an Appointment</a></li><li class="f5 f4-ns fw4 dib-l db pr3-l pv2"><a class="hover-white no-underline white-90 db" href=/about/ title="About MindSing page">About MindSing</a></li><li class="f5 f4-ns fw4 dib-l db pr3-l pv2"><a class="hover-white no-underline white-90 db" href=/blog/ title="Blog page">Blog</a></li><li class="f5 f4-ns fw4 dib-l db pr3-l pv2"><a class="hover-white no-underline white-90 db" href=/services/ title="Services page">Services</a></li></ul></div></div></nav><script src=/js/hamburger-menu.min.e47f1f4c8d04eeecb3e7d44d3097ed007ab5bcabd118411e8fc7ad6b92808426.js></script></div></header><main class=pb3 role=main><article class="flex-l flex-wrap justify-between center ph3 ph5-l mw8"><header class="mt4 w-100"><h2 class="f1 athelas mt3 mb1"></h2></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l"><h1 id=calculator-url-token-behavior>Calculator: URL Token Behavior</h1><p>This README explains how the calculator serializes form values into an opaque token placed in the browser URL so results can be saved and later decoded to repopulate the form.</p><p>Where implemented:</p><ul><li>Helpers are in <code>web/assets/js/form__helpers.js</code>.</li><li>The DIME calculator uses these helpers in <code>web/assets/js/form__dime-calculator.js</code>.</li></ul><p>What it does:</p><ul><li>When the calculator <code>Calculate</code> button is clicked the DIME calculator now creates an opaque token: a base64url-encoded JSON blob containing the serialized form values.</li><li>The token is written to the query string as <code>?{token}</code> (for example <code>?eyJhb...</code>) using <code>history.replaceState()</code> so the page does not reload.</li><li>The token is reversible — it can be decoded back into the original form values.</li></ul><p>Programmatic usage:</p><ul><li>Create token from a form:</li><li><code>var token = await window.formHelpers.createTokenFromForm(form);</code> (returns a Promise; use <code>await</code> or <code>.then()</code>)</li><li>Write token to the URL query string:<ul><li><code>window.formHelpers.writeTokenToQuery(token);</code> (writes <code>?{token}</code>)</li></ul></li><li>Decode token into an object:<ul><li><code>var values = window.formHelpers.decodeTokenToObject(token);</code></li></ul></li><li><code>var values = await window.formHelpers.decodeTokenToObject(token);</code> (returns a Promise resolving to the object)</li><li>Populate a form from a token:<ul><li><code>window.formHelpers.populateFormFromToken(token, form);</code></li></ul></li><li>Utilities:<ul><li><code>window.formHelpers.base64UrlEncode(str)</code> and <code>base64UrlDecode(str)</code> are also available.</li></ul></li></ul><p>Signing and salts</p><ul><li>To prevent casual decoding of tokens, pages can include a <code>token_salt</code> value in their front matter and the form can carry the same value in a <code>data-token-salt</code> attribute.</li><li>When a salt is provided, tokens are signed with HMAC-SHA256(payload, salt) and written as <code>{payload}.{sig}</code> where <code>payload</code> is base64url(JSON) and <code>sig</code> is the base64url HMAC.</li><li>Verification is supported: call <code>window.formHelpers.decodeTokenToObject(token, { salt: '&lt;page-salt>' })</code>. If verification fails an empty object is returned.</li></ul><p>How to generate salts for pages</p><ul><li>Use a cryptographically secure random string. Example (Node):</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>node -e <span style=color:#e6db74>&#34;console.log(require(&#39;crypto&#39;).randomBytes(32).toString(&#39;base64&#39;).replace(/\+/g,&#39;-&#39;).replace(/\//g,&#39;_&#39;).replace(/=+</span>$<span style=color:#e6db74>/,&#39;&#39;))&#34;</span>
</span></span></code></pre></div><ul><li>Or on macOS / Linux (OpenSSL):</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl rand -base64 <span style=color:#ae81ff>32</span> | tr <span style=color:#e6db74>&#39;+/&#39;</span> <span style=color:#e6db74>&#39;-_&#39;</span> | tr -d <span style=color:#e6db74>&#39;=&#39;</span>
</span></span></code></pre></div><ul><li>The salt can be any reasonably long random string (at least 32 bytes before encoding recommended). Store it in the page front matter as <code>token_salt</code> and set the same value on the <code>&lt;form></code> as <code>data-token-salt</code>.</li></ul><p>Security notes</p><ul><li>The salt is required for verification; without it tokens are trivially decodable because the payload is just base64url(JSON).</li><li>The salt should be treated as a secret for pages where you want to prevent casual decoding. It should be stored in source (front matter) but not exposed publicly if you need strong secrecy (note: if the page is public, front matter may be visible in the repo).</li></ul><p>Password protection and encrypted sharing</p><ul><li>Calculator pages can be password-protected by adding a <code>password: "yourpassword"</code> field to the front matter.</li><li>When a user unlocks protected content by entering the correct password, the plaintext password is automatically stored in localStorage under the key <code>password_gate:{page-id}</code> (where <code>{page-id}</code> is the <code>data-protect-id</code> attribute).</li><li>This stored password enables encrypted sharing functionality: when the Calculate button is clicked, the form data is encrypted using AES-GCM with the stored password and embedded in a shareable URL.</li><li>Encrypted share URLs have the format: <code>?ct=...&amp;iv=...&amp;salt=...#key=password</code> where the ciphertext is in the query string and the decryption key is in the URL fragment.</li><li>The &ldquo;Add Key&rdquo; functionality allows users to paste encrypted ciphertext (starting with <code>ct=...</code>) to decrypt and populate the form, automatically triggering calculation.</li><li>The password storage system ensures that encrypted keys can be decrypted even after page refreshes, as long as the user has previously unlocked the content.</li></ul><p>How password protection works:</p><ol><li>Hugo generates a SHA-256 hash of the password and places it in the DOM as <code>data-protect-password-hash</code></li><li>User enters password, which gets hashed client-side and compared to the stored hash</li><li>On successful unlock: password is stored in localStorage, hash is removed from DOM for security</li><li>The plaintext password in localStorage is used for encrypting/decrypting shared form data</li></ol><p>Automatic population on page load</p><ul><li>If you want the page to auto-populate the form when a token is present in the URL, call <code>formHelpers.populateFormFromToken(token, form)</code> on load. If the token is signed and a salt is present, pass the salt when decoding via <code>decodeTokenToObject</code>.</li></ul><p>How to opt-in any form (auto-bind):</p><ul><li>Add the attribute <code>data-hash-on-submit</code> to a <code>&lt;form></code> element and call <code>formHelpers.initHashOnSubmit()</code> for dynamically injected content. (The helper exists primarily for the readable-fragment workflow; DIME uses the token flow programmatically.)</li><li>If you want the form to be submitted normally after hashing, add <code>data-submit-after-hash="true"</code>.</li></ul><p>Notes & troubleshooting:</p><ul><li>Sensitive fields such as passwords and file inputs are ignored by the serializer.</li><li>Check that fields have either <code>name</code> or <code>id</code> attributes — those are used as keys.</li><li>If you want the token to be included in a sharable link, copy the full URL including the <code>?{token}</code> part.</li></ul><p>If you want, I can also add automatic token decoding on page load to repopulate the calculator if a token exists in the URL. Would you like that?</p></div><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l"><ul class="pa0 list ma0"></ul></div><aside class="w-30-l mt6-l"></aside></article></main><section class="bg-near-white pa4 pa5-ns tc"><div class="center mw8"><h2 class="f2 fw6 mb3">Ready to Scale Your Web Presence?</h2><p class="f4 lh-copy mb4">Contact us to discuss your enterprise web development needs:</p><p class="f4 fw6 mb4"><strong>Email:</strong>
<a href=mailto:inquiries@mindsing.com class="link orange dim">inquiries@mindsing.com</a></p><div class="flex flex-column flex-row-ns justify-center items-center"><a href=/booking/ class="btn btn--primary mr3-ns mb3 mb0-ns">Schedule a Consultation
</a><a href=/services/ class="btn btn--secondary">View Our Services</a></div></div></section><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dib-ns pv2 ph3" href=/>&copy; MindSing 2025</a><div class="flex items-center"><a href=/services/ class="f6 fw4 hover-white no-underline white-70 dib ml3 ph2">Services</a>
<a href=/blog/ class="f6 fw4 hover-white no-underline white-70 dib ml3 ph2">Blog</a>
<a href=/about/ class="f6 fw4 hover-white no-underline white-70 dib ml3 ph2">About</a>
<a href=/privacy-policy/ class="f6 fw4 hover-white no-underline white-70 dib ml3 ph2">Privacy Policy</a></div></div></footer><div id=privacy-banner class="fixed bottom-0 left-0 w-100 pa3 bg-black-80 white z-999" style=display:none><div class="center mw8 flex flex-wrap items-center justify-between"><div class="w-100 w-two-thirds-ns pr3-ns"><p class=ma0>This website uses cookies to ensure you get the best experience.
<a href=/privacy-policy/ class="link white underline">Learn more</a> about our privacy practices.</p></div><div class="w-100 w-third-ns mt2 mt0-ns tr-ns"><a id=reject-privacy class="link white underline mr3 pointer">Reject All
</a><button id=accept-privacy class="ba b--white-40 bg-transparent white pv2 ph3 pointer hover-bg-white-20 br2">
Accept
</button>
<button id=acknowledge-privacy class="ba b--white-40 bg-transparent white pv2 ph3 pointer hover-bg-white-20 br2">
Acknowledge</button></div></div></div><script src=/js/afterLoad.min.d2a512f21d93c13a4bcaae81c2572e0b978c257fcb76d2597bead5f0e7a48670.js></script><script src=/js/user-settings.min.8c8f41500156d194b2e3123fb2140c3a53482ef70ed8ceb28603b54ab7c48ae1.js></script><script>window.HUGO_ENV="production"</script><script src=/js/tracking.min.df3895874346df2f0e3b377e659337f2fc76a749e282721ccce1f73a3bc7a142.js></script><script src=/js/page-tracking.min.3e9797018b5923e30b32a2b5eb2990f2a60776cf2ea587fe734e027e87bf1b2c.js></script><script src=/js/external-links.min.d562ddca0eb357200d83be54566b7c126f3c1443d09e4c285cfa595994ff7d11.js></script></body></html>